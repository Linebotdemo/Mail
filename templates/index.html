<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf_token" content="{{ csrf_token() }}">
    <title>ç½²åç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    <!-- CSSãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.quilljs.com/1.3.6/quill.snow.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- JavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆheadå†…ï¼‰ -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
<script>
    const currentUser = {{ {
        "employee_id": current_user.employee_id if current_user.is_authenticated and current_user.employee_id is not none else 1
    } | tojson | safe }};
</script>

</head>
<body>
    <!-- ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div id="toast-container" class="toast-container position-fixed top-0 end-0 p-3"></div>

<!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
<nav class="sidebar">
    <div class="sidebar-header">
        <h3>ç½²åç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h3>
    </div>
    <ul class="nav flex-column">
        {% if user_role == 'admin' %}
        <li class="nav-item">
            <a class="nav-link" data-view="dashboard" href="#">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
        </li>
        {% endif %}

        <li class="nav-item">
            <a class="nav-link" data-view="employee-portal" href="#">ç¤¾å“¡ãƒãƒ¼ã‚¿ãƒ«</a>
        </li>

        {% if user_role == 'admin' %}
        <li class="nav-item">
            <a class="nav-link" data-view="template-editor" href="#">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-view="campaign-manager" href="#">ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-view="analytics" href="#">åŠ¹æœæ¸¬å®š</a>
        </li>

        {% endif %}

        <!-- ğŸ”“ ã“ã‚Œã¯å…¨ãƒ­ãƒ¼ãƒ«å…±é€šã§è¡¨ç¤º -->
        <li class="nav-item">
            <a class="nav-link" data-view="profile-editor" href="#">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</a>
        </li>

        <li class="nav-item">
            <meta name="csrf_token" content="{{ csrf_token() }}">
            <a class="nav-link" href="#" id="logout-link">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
        </li>
    </ul>
</nav>


<!-- ç¤¾å“¡ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal fade" id="editEmployeeModal" tabindex="-1" aria-labelledby="editEmployeeModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editEmployeeModalLabel">ç¤¾å“¡ç·¨é›†</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="edit-employee-form">
          <input type="hidden" id="edit-employee-id" name="id">
          <input type="hidden" name="organization_id">
          
          <div class="form-group">
            <label for="edit-name">åå‰</label>
            <input type="text" id="edit-name" name="name" class="form-control" required>
          </div>
          
          <div class="form-group mt-3">
            <label for="edit-email">ãƒ¡ãƒ¼ãƒ«</label>
            <input type="email" id="edit-email" name="email" class="form-control" required>
          </div>
          
          <div class="form-group mt-3">
            <label for="edit-department">éƒ¨ç½²</label>
            <input type="text" id="edit-department" name="department" class="form-control">
          </div>
          
          <div class="form-group mt-3">
            <label for="edit-role">å½¹å‰²</label>
            <select id="edit-role" name="role" class="form-control">
              <option value="employee">ç¤¾å“¡</option>
              <option value="admin">ç®¡ç†è€…</option>
            </select>
          </div>
          
          <button type="submit" class="btn btn-primary mt-3">ä¿å­˜</button>
        </form>
      </div>
    </div>
  </div>
</div>


    <!-- ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°URLãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal fade" id="trackingUrlModal" tabindex="-1" aria-labelledby="trackingUrlModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="trackingUrlModalLabel">ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãƒªãƒ³ã‚¯ç”Ÿæˆçµæœ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é–‰ã˜ã‚‹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="errorModalLabel">ã‚¨ãƒ©ãƒ¼</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é–‰ã˜ã‚‹</button>
                </div>
            </div>
        </div>
    </div>
</div>



    <div id="profile-editor" class="content-section hidden">
        <div class="container">
            <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</h3>
            <form id="profile-form">
<div class="mb-2">
  <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</label>
  <input type="password" name="password" id="password" class="form-control" placeholder="æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
</div>

<div class="mb-2">
  <label for="password-confirm">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ ç¢ºèª</label>
  <input type="password" name="password_confirm" id="password-confirm" class="form-control" placeholder="ã‚‚ã†ä¸€åº¦å…¥åŠ›">
</div>
                <div class="mb-2"><label>æ°å</label><input name="name" class="form-control" required></div>
                <div class="mb-2"><label>ãƒ¡ãƒ¼ãƒ«</label><input name="email" class="form-control" required></div>
                <div class="mb-2"><label>éƒ¨ç½²</label><input name="department" class="form-control"></div>
                <div class="mb-2"><label>å½¹è·</label><input name="role" class="form-control"></div>
                <div class="mb-2"><label>é›»è©±ç•ªå·</label><input name="phone" class="form-control"></div>
                <div class="mb-2"><label>ä½æ‰€</label><input name="address" class="form-control"></div>
                <div class="mb-2"><label>Webã‚µã‚¤ãƒˆ</label><input name="website" class="form-control"></div>
                <div class="mb-2"><label>LinkedIn</label><input name="linkedin" class="form-control"></div>

                <button type="submit" class="btn btn-primary mt-2">ä¿å­˜</button>
            </form>
        </div>
    </div>
<!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
<div class="content" style="max-width: 100%; overflow-x: auto;">
    <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆç®¡ç†è€…ç”¨ï¼‰ -->
    {% if user_role == 'admin' %}
    <div id="dashboard" class="content-section hidden">
        <h2>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>

        <!-- ğŸ”¼ çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¸Šã«ç§»å‹•ï¼‰ -->
<div class="row mt-4">
  <div class="col-md-12">
    <h3>çµ±è¨ˆ</h3>
    <div id="stats-content" class="d-flex gap-4"></div>
  </div>
</div>


        <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ -->
        <div class="row mt-4">
            <div class="col-md-6">
                <h3>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h3>
                <div class="table-responsive">
                    <table class="table table-striped" id="template-list">
                        <thead>
                            <tr>
                                <th>åå‰</th>
                                <th>ä½œæˆæ—¥</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for template in templates %}
                            <tr>
                                <td>{{ template.name }}</td>
                                <td>{{ template.created_at | strftime('%Y/%m/%d %H:%M') }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-template" data-id="{{ template.id }}">ç·¨é›†</button>
                                    <button class="btn btn-sm btn-danger delete-template" data-id="{{ template.id }}">å‰Šé™¤</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-6">
                <h3>ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³</h3>
                <div class="table-responsive">
                    <table class="table table-striped" id="campaign-list">
                        <thead>
                            <tr>
                                <th>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</th>
                                <th>éƒ¨ç½²</th>
                                <th>é–‹å§‹æ—¥</th>
                                <th>çµ‚äº†æ—¥</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for campaign in campaigns %}
                            <tr>
                                <td>
                                    {% set names = [] %}
                                    {% for tid in (campaign.template_ids | default("[]") | from_json) %}
                                        {% set matched = templates | selectattr('id', 'equalto', tid | int) | list %}
                                        {% if matched and matched[0] and 'name' in matched[0] %}
                                            {% set names = names + [matched[0].name] %}
                                        {% else %}
                                            {% set names = names + ['ä¸æ˜'] %}
                                        {% endif %}
                                    {% endfor %}
                                    {{ names | join(', ') }}
                                </td>
                                <td>{{ campaign.department or 'å…¨ã¦' }}</td>
                                <td>{{ campaign.start_date | strftime('%Y/%m/%d %H:%M') }}</td>
                                <td>{{ campaign.end_date | strftime('%Y/%m/%d %H:%M') }}</td>
                                <td>
                                    <button class="btn btn-sm btn-primary edit-campaign" data-id="{{ campaign.id }}">ç·¨é›†</button>
                                    <button class="btn btn-sm btn-danger delete-campaign" data-id="{{ campaign.id }}">å‰Šé™¤</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ç¤¾å“¡ç®¡ç†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="row mt-4">
            <div class="col-md-12">
                <h3>ç¤¾å“¡ç®¡ç†</h3>
                <form id="employee-filter-form" class="mb-3">
                    <div class="row">
                        <div class="col-md-3">
                            <input type="text" id="filter-name" class="form-control" placeholder="åå‰">
                        </div>
                        <div class="col-md-3">
                            <input type="text" id="filter-email" class="form-control" placeholder="ãƒ¡ãƒ¼ãƒ«">
                        </div>
                        <div class="col-md-3">
                            <input type="text" id="filter-department" class="form-control" placeholder="éƒ¨ç½²">
                        </div>
                        <div class="col-md-3">
                            <select id="filter-role" class="form-control">
                                <option value="">å½¹å‰²</option>
                                <option value="employee">ç¤¾å“¡</option>
                                <option value="admin">ç®¡ç†è€…</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <input type="text" id="search-query" class="form-control" placeholder="æ¤œç´¢">
                        </div>
                        <div class="col-md-6">
                            <button type="submit" class="btn btn-primary">ãƒ•ã‚£ãƒ«ã‚¿</button>
                            <button type="button" id="reset-filters" class="btn btn-secondary">ãƒªã‚»ãƒƒãƒˆ</button>
                        </div>
                    </div>
                </form>
                <div class="table-responsive">
                    <table class="table table-striped" id="employee-list">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="name">åå‰ <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="email">ãƒ¡ãƒ¼ãƒ« <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="department">éƒ¨ç½² <i class="fas fa-sort"></i></th>
                                <th class="sortable" data-sort="role">å½¹å‰² <i class="fas fa-sort"></i></th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <nav>
                    <ul class="pagination" id="employee-pagination"></ul>
                </nav>
                <h4>ç¤¾å“¡ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h4>
                <form id="employee-import-form" enctype="multipart/form-data">
                    <div class="input-group mb-3">
                        <input type="file" class="form-control" name="file" accept=".csv">
                        <button type="submit" class="btn btn-primary">ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- ç¤¾å“¡ãƒãƒ¼ã‚¿ãƒ« -->
    <div id="employee-portal" class="content-section hidden" data-employee-id="{{ employee_id }}" data-template-id="{{ assigned_template_id }}">
        <div class="container">
            <!-- ãƒ‡ãƒãƒƒã‚°ç”¨ï¼ˆæœ¬ç•ªã§ã¯å‰Šé™¤å¯ï¼‰ -->
            <p>employee_id: {{ employee_id }}</p>
            <p>assigned_template_id: {{ assigned_template_id }}</p>
            <h2>ç¤¾å“¡ãƒãƒ¼ã‚¿ãƒ«</h2>
            <div id="signature-error" class="alert alert-danger hidden"></div>
            <h3>HTMLç½²å</h3>
            <div id="html-signature" class="border p-3 mb-3 noselect"></div>
            <button class="btn btn-primary copy-btn" data-target="#html-signature">ã‚³ãƒ”ãƒ¼</button>
            <h3>ãƒ†ã‚­ã‚¹ãƒˆç½²å</h3>
            <pre id="text-signature" class="border p-3 mb-3 noselect"></pre>
            <button class="btn btn-primary copy-btn" data-target="#text-signature">ã‚³ãƒ”ãƒ¼</button>
        </div>
    </div>

    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆç®¡ç†è€…ç”¨ï¼‰ -->
    {% if user_role == 'admin' %}
    <div id="template-editor" class="content-section hidden">
        <div class="container">
            <h2>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</h2>
            <form id="template-form" data-template-id="">
                <div class="form-group">
                    <label for="template-name">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå</label>
                    <input type="text" id="template-name" class="form-control" required>
                </div>
                <div class="form-group mt-3">
                    <label>HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„</label>
                    <div id="quill-editor" class="quill-editor"></div>
                    <textarea id="html-content" class="hidden"></textarea>
                </div>
                <div class="form-group mt-3">
                    <label for="text-content">ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„</label>
                    <textarea id="text-content" class="form-control"></textarea>
                    <div id="text-preview" class="mt-2"></div>
                </div>
                <div class="form-group mt-3">
                    <label for="banner-url">ãƒãƒŠãƒ¼URL</label>
                    <input type="url" id="banner-url" class="form-control">
                </div>
                <div class="mt-3" id="placeholder-buttons"></div>
                <div class="mt-3">
                    <button type="button" id="generate-track-btn" class="btn btn-outline-success">ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãƒªãƒ³ã‚¯ç”Ÿæˆ</button>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-outline-primary device-preview-btn" data-device="desktop">ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—</button>
                    <button type="button" class="btn btn-outline-primary device-preview-btn" data-device="tablet">ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ</button>
                    <button type="button" class="btn btn-outline-primary device-preview-btn" data-device="mobile">ãƒ¢ãƒã‚¤ãƒ«</button>
                </div>
                <div class="mt-3">
                    <iframe id="template-preview" class="template-preview" style="max-width: 100%;"></iframe>
                </div>
                <div id="tracking-url-container" class="mt-3"></div>
                <button type="submit" class="btn btn-primary mt-3">ä¿å­˜</button>
            </form>
        </div>
    </div>

    <!-- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†ï¼ˆç®¡ç†è€…ç”¨ï¼‰ -->
    <div id="campaign-manager" class="content-section hidden">
        <div class="container">
            <h2>ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†</h2>
            <form id="campaign-form">
                <div class="form-group">
                    <label for="template-ids">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</label>
                    <select id="template-ids" class="form-control" multiple required></select>
                </div>
                <div class="form-group mt-3">
                    <label for="department">éƒ¨ç½²</label>
                    <select id="department" class="form-control">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        {% for dept in departments %}
                        <option value="{{ dept }}">{{ dept }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group mt-3">
                    <label for="date-range">æ—¥ä»˜ç¯„å›²</label>
                    <input type="text" id="date-range" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary mt-3">ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä½œæˆ</button>
            </form>
        </div>
    </div>

<!-- åŠ¹æœæ¸¬å®šï¼ˆç®¡ç†è€…ç”¨ï¼‰ -->
<div id="analytics" class="content-section hidden">
  <div class="container">
    <h2>åŠ¹æœæ¸¬å®š</h2>

    <div class="row my-3">
      <div class="col-md-3">
        <label for="filter-start-date">é–‹å§‹æ—¥</label>
        <input type="text" id="filter-start-date" class="form-control" placeholder="YYYY-MM-DD">
      </div>
      <div class="col-md-3">
        <label for="filter-end-date">çµ‚äº†æ—¥</label>
        <input type="text" class="form-control filter-end-date" placeholder="YYYY-MM-DD">
      </div>
      <div class="col-md-3 align-self-end">
        <button id="apply-date-filter" class="btn btn-primary">çµã‚Šè¾¼ã¿</button>
      </div>
    </div>

    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" data-analytics-tab="abtest" href="#">A/Bãƒ†ã‚¹ãƒˆ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-analytics-tab="department" href="#">éƒ¨ç½²åˆ¥</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-analytics-tab="employee" href="#">ç¤¾å“¡åˆ¥</a>
      </li>
    </ul>

    <!-- âœ… A/Bãƒ†ã‚¹ãƒˆ -->
    <div id="abtest-tab" class="analytics-tab-content">
      <h3>å‹åˆ©ãƒãƒŠãƒ¼: <span id="winner-banner"></span></h3>

      <p id="no-abtest-data" class="text-muted text-center my-3" style="display: none;">
        è©²å½“ã™ã‚‹A/Bãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
      </p>

      <div class="table-responsive">
        <table class="table table-striped" id="ab-test-table">
          <thead>
            <tr>
              <th>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</th>
              <th>ã‚¯ãƒªãƒƒã‚¯æ•°</th>
              <th>CTR</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <h3>æ™‚é–“å¸¯åˆ†æ</h3>
      <p id="no-timeband-data" class="text-muted text-center my-3" style="display: none;">
        æ™‚é–“å¸¯ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚
      </p>
      <canvas id="timebandChart" width="400" height="200"></canvas>
    </div>

    <!-- âœ… éƒ¨ç½²åˆ¥ -->
    <div id="department-tab" class="analytics-tab-content hidden">
      <h3>éƒ¨ç½²åˆ¥ã‚¯ãƒªãƒƒã‚¯æ•°</h3>

      <p id="no-department-data" class="text-muted text-center my-3" style="display: none;">
        è©²å½“ã™ã‚‹éƒ¨ç½²åˆ¥ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
      </p>

      <div class="table-responsive">
        <table class="table table-striped" id="department-table">
          <thead>
            <tr>
              <th>éƒ¨ç½²</th>
              <th>ã‚¯ãƒªãƒƒã‚¯æ•°</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <canvas id="departmentChart" width="400" height="200"></canvas>
    </div>

    <!-- âœ… ç¤¾å“¡åˆ¥ -->
<div id="employee-tab" class="analytics-tab-content hidden">
  <h3>ç¤¾å“¡åˆ¥ã‚¯ãƒªãƒƒã‚¯æ•°</h3>

  <p id="no-employee-data" class="text-muted text-center my-3" style="display: none;">
    è©²å½“ã™ã‚‹ç¤¾å“¡åˆ¥ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
  </p>

  <!-- âœ… â† ã“ã® wrapper ã‚’è¿½åŠ  -->
  <div id="employee-table-wrapper">
    <div class="table-responsive">
      <table class="table table-striped" id="employee-analytics-table">
        <thead>
          <tr>
            <th>ç¤¾å“¡</th>
            <th>éƒ¨ç½²</th>
            <th>ã‚¯ãƒªãƒƒã‚¯æ•°</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <canvas id="employeeChart" width="400" height="200"></canvas>
  </div>
</div>




    <!-- ç½²åå±¥æ­´ï¼ˆç®¡ç†è€…ç”¨ï¼‰ -->
    <div id="signature-history" class="content-section hidden">
        <div class="container">
            <h2>ç½²åå±¥æ­´</h2>
            <form id="history-filter-form">
                <div class="row">
                    <div class="col-md-4">
                        <label for="filter-employee">ç¤¾å“¡</label>
                        <select id="filter-employee" class="form-control">
                            <option value="">å…¨ã¦</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="filter-start-date">é–‹å§‹æ—¥</label>
                        <input type="date" id="filter-start-date" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label for="filter-end-date">çµ‚äº†æ—¥</label>
                        <input type="date" id="filter-end-date" class="form-control">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary mt-3">ãƒ•ã‚£ãƒ«ã‚¿</button>
            </form>
            <div class="table-responsive">
                <table class="table table-striped mt-3" id="history-table">
                    <thead>
                        <tr>
                            <th>ç¤¾å“¡</th>
                            <th>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</th>
                            <th>é©ç”¨æ—¥æ™‚</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}




<!-- JavaScriptï¼ˆbodyæœ«å°¾ï¼‰ -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ja.js"></script>
<script src="{{ url_for('static', filename='js/script.js') }}?v=1.0"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
</body>
</html>
